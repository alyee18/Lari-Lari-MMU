<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="myscripts.js" defer></script>
    
</head>
<body>
    <header>
        <h2>Admin Dashboard</h2>
    </header>
    <div class="sidebar">
        <ul>
            <li><i class='bx bx-home'></i><a href="/admin">Dashboard</a></li>
            <li><i class='bx bx-user'></i><a href="/usercontrol">User Control</a></li>
            <li><i class='bx bx-cart'></i><a href="/ordercontrol">Order Control</a></li>
            <li><i class='bx bx-food-menu'></i><a href="/menucontrol">Menu Control</a></li>
            <li><i class='bx bx-coin-stack'></i><a href="/finance">Financial Overview</a></li>
            <li><i class='bx bx-edit'></i><a href="/pageeditor">Page Editor</a></li>
            <li><i class='bx bx-log-out'></i><a href="/logout">Logout</a></li>
        </ul>
    </div>
    <div class="admincontainer">
      <div class="subadmincontainer">
          <div class="subdes">
              <h2>{{ num_orders }}</h2>
              <h4>Orders</h4>
          </div>
          <div class="icon">
              <i class='bx bxs-cart'></i>
          </div>
      </div>
      <div class="subadmincontainer">
          <div class="subdes">
              <h2>{{ num_runners }}</h2>
              <h4>Runners</h4>
          </div>
          <div class="icon">
              <i class='bx bxs-bike'></i>
          </div>
      </div>
      <div class="subadmincontainer">
          <div class="subdes">
              <h2>{{ num_buyers }}</h2>
              <h4>Buyers</h4>
          </div>
          <div class="icon">
              <i class='bx bxs-user'></i>
          </div>
      </div>
      <div class="subadmincontainer">
          <div class="subdes">
              <h2>{{ num_sellers }}</h2>
              <h4>Sellers</h4>
          </div>
          <div class="icon">
              <i class='bx bxs-store'></i>
          </div>
      </div>
  </div>
  <input type="hidden" id="num_orders" value="{{ num_orders }}">
  <input type="hidden" id="num_runners" value="{{ num_runners }}">
  <input type="hidden" id="num_buyers" value="{{ num_buyers }}">
  <input type="hidden" id="num_sellers" value="{{ num_sellers }}">
  <div class="graphcontainer">
      <div class="graph">
          <canvas id="ordersChart" width="500"></canvas>
      </div>
      <div class="graph">
          <canvas id="usersChart"></canvas>
      </div>
  </div>
  <div class="table" id="orders_table">
      <div class="table__header">
          <h1>Orders List</h1>
          <div class="input-group">
              <input type="search" id="search" placeholder="Search Orders...">
              <i class='bx bx-search' onclick="searchOrders()"></i>
          </div>
      </div>
      <div class="table__body">
          <table>
              <thead>
                  <tr>
                      <th>Order ID</th>
                      <th>Buyer</th>
                      <th>Seller</th>
                      <th>Item</th>
                      <th>Quantity</th>
                      <th>Status</th>
                      <th>Date</th>
                  </tr>
              </thead>
              <tbody>
                  {% for order in orders %}
                  <tr>
                      <td>{{ order.id }}</td>
                      <td>{{ order.buyer }}</td>
                      <td>{{ order.seller }}</td>
                      <td>{{ order.item }}</td>
                      <td>{{ order.quantity }}</td>
                      <td>{{ order.status }}</td>
                      <td>{{ order.date }}</td>
                  </tr>
                  {% endfor %}
              </tbody>                               
          </table>
      </div>
  </div>
  <script>
      // Define a function named searchOrders
      function searchOrders() {
          const searchQuery = document.getElementById('search').value;
          window.location.href = `/admin?search=${searchQuery}`;
      }

      // Sample code to initialize charts
      const ctxOrders = document.getElementById('ordersChart').getContext('2d');
      const ordersChart = new Chart(ctxOrders, {
          type: 'bar',
          data: {
              labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
              datasets: [{
                  label: 'Orders',
                  data: [10, 20, 15, 25, 30, 20],
                  backgroundColor: 'rgba(75, 192, 192, 0.2)',
                  borderColor: 'rgba(75, 192, 192, 1)',
                  borderWidth: 1
              }]
          },
          options: {
              scales: {
                  y: {
                      beginAtZero: true
                  }
              }
          }
      });

      const ctxUsers = document.getElementById('usersChart').getContext('2d');
      const usersChart = new Chart(ctxUsers, {
          type: 'pie',
          data: {
              labels: ['Runners', 'Buyers', 'Sellers'],
              datasets: [{
                  data: [{ num_runners }, { num_buyers }, { num_sellers }],
                  backgroundColor: ['rgba(255, 99, 132, 0.2)', 'rgba(54, 162, 235, 0.2)', 'rgba(255, 206, 86, 0.2)'],
                  borderColor: ['rgba(255, 99, 132, 1)', 'rgba(54, 162, 235, 1)', 'rgba(255, 206, 86, 1)'],
                  borderWidth: 1
              }]
          }
      });
  </script>
</body>
</html>